symbol: BTCUSDT
category: spot
interval: 5
seed: 42
device: auto
allow_cpu_fallback: true

dataset:
  start_date: "2023-01-01"
  end_date: "2023-01-30"
  limit_per_call: 1000
  output_path: "data/processed/btcusdt_spot_5m_2023-01-01_2023-01-30.parquet"

parity:
  duration_sec: 120
  ws_topic: "kline.5.BTCUSDT"
  rest_compare_mode: "kline"
  target_closed_candles: 3
  max_wait_sec: 1200

features:
  window_size_K: 32
  feature_set_id: null
  feature_sets_path: "features/feature_sets.yaml"
  list_of_features:
    - returns
    - log_returns
    - volatility
    - volatility_20
    - range
    - body
    - upper_wick
    - lower_wick
    - volume
    - volume_change
    - volume_zscore_20
    - sma_5
    - sma_20
    - ema_12
    - ema_26
    - ema_diff
    - rsi_14
    - roc_5
    - momentum_10
    - atr_14

supervised:
  epochs: 50
  batch_size: 64
  lr: 0.001
  early_stopping_patience: 10
  weight_decay: 0.0001
  hidden_dim: 64

rl:
  episodes: 50
  steps_per_episode: 200
  gamma: 0.99
  lr: 0.001
  reward:
    R_correct: 1.0
    R_wrong: 1.0
    R_opposite: 2.0
    margin_threshold: 0.04
    margin_penalty: 0.3
  entropy_bonus: 0.02
  policy_hidden_dim: 64

decision_rule:
  T_min: 0.50
  delta_min: 0.04
  delta_grid: [0.02, 0.04, 0.06, 0.08]
  use_best_from_scan: true
  scan_min: 0.45
  scan_max: 0.75
  scan_step: 0.01

viz:
  out_dir: "reports"
  moving_window: 20
  save_formats: ["png", "svg"]

tuner:
  mode: agent
  episodes: 50
  agent_train_episodes: 5
  agent_steps_per_episode: 200
  online_split_ratio: 0.15
  entropy_bonus: 0.01
  lr: 0.1
  reward:
    decision_accuracy_weight: 0.0
    decision_action_rate_weight: 0.0
    decision_conflict_penalty: 0.0
    decision_hold_penalty: 0.0
    decision_min_session_accuracy_weight: 0.0
    decision_min_session_precision_up_weight: 0.0
    decision_min_session_precision_down_weight: 0.0
    decision_max_session_hold_penalty: 0.0
    decision_max_session_conflict_penalty: 0.0
    rl_up_accuracy_weight: 0.2
    rl_down_accuracy_weight: 0.4
    online_rl_up_accuracy_weight: 0.3
    online_rl_down_accuracy_weight: 0.5
    rl_up_error_balance_penalty: 0.2
    rl_down_error_balance_penalty: 0.2
    rl_up_hold_penalty: 0.1
    rl_down_hold_penalty: 0.2
    improve_up_accuracy_weight: 0.4
    improve_down_accuracy_weight: 0.4
  feature_selection:
    enabled: true
    top_n: 6
    corr_threshold: 0.98
    var_threshold: 1e-12
  search:
    explore_prob: 0.1
    mutate_prob: 0.5
    max_mutations: 2
    neighbor_only: false
    always_mutate: true
  param_space:
    features.feature_set_id:
      - CORE_MINIMAL
      - CORE_TREND
      - CORE_VOL
      - CORE_VOLUME
      - CORE_ALL
      - MTF_LIGHT
      - SESSION_FRIENDLY
    features.window_size_K: [16, 32]
    supervised.epochs: [50]
    supervised.batch_size: [64]
    supervised.lr: [0.001, 0.0005]
    supervised.weight_decay: [0.0001, 0.0]
    supervised.hidden_dim: [64, 128]
    supervised.early_stopping_patience: [10]
    decision_rule.T_min: [0.45, 0.50, 0.55, 0.60]
    decision_rule.delta_min: [0.02, 0.04, 0.08]
    decision_rule.use_best_from_scan: [true]
    decision_rule.scan_min: [0.45]
    decision_rule.scan_max: [0.75]
    decision_rule.scan_step: [0.01]
    rl.episodes: [50]
    rl.steps_per_episode: [200]
    rl.gamma: [0.99]
    rl.lr: [0.001, 0.0005]
    rl.entropy_bonus: [0.02, 0.0]
    rl.reward.R_correct: [1.0]
    rl.reward.R_wrong: [1.0]
    rl.reward.R_opposite: [2.0, 1.5]
    rl.reward.margin_threshold: [0.02, 0.04, 0.06]
    rl.reward.margin_penalty: [0.3, 0.4]
    rl.policy_hidden_dim: [64, 128]

adaptation:
  min_action_accuracy: 0.53
  min_action_rate: 0.4
  max_hold_rate: 0.35
  max_conflict_rate: 0.15
  min_precision_up: 0.53
  min_precision_down: 0.51
  min_rl_up_accuracy: 0.52
  min_rl_down_accuracy: 0.47
  max_rl_up_hold_rate: 0.6
  max_rl_down_hold_rate: 0.6
  max_drift_score: 0.2

session:
  mode: fixed_utc_partitions
  overlap_policy: priority
  priority_order: [US, EUROPE, ASIA]
  strategy: experts_per_session
  sessions:
    ASIA:
      start: "00:00"
      end: "08:00"
      overrides: {}
    EUROPE:
      start: "08:00"
      end: "16:00"
      overrides: {}
    US:
      start: "16:00"
      end: "24:00"
      overrides: {}
